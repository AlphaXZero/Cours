SELECT mainom from maisons left join personnages on permaiid=maiid where perid is NULL;
SELECT mainom, count(perid) from maisons left join personnages on permaiid=maiid group by maiid;
select filTitre,filannee from films where filannee>2007 order by FilAnnee limit 1;
select pernom, perprenom from personnages inner join rolesimportants on perid=rolperid inner join films on rolfilid=filid where filid=(select filid from films where filcout = (select min(filcout) from films));
select persexe, count(perid) from personnages inner join maisons on maiid=permaiid where mainom="Gryffondor" group by persexe;
select * from (select maiid as id1, mainom, count(perid) as nbr_h from personnages INNER join maisons on PerMaiID=maiid where persexe="h" group by maiid,mainom) as T1 inner join (select maiid as id2, count(perid) as nbr_f from personnages INNER join maisons on PerMaiID=maiid where persexe="f" group by maiid,mainom) as t2 on id1=id2 where nbr_f > nbr_h;
select filTitre from films where filsuite is null;
select pernom,perprenom from personnagess where perid not in (select perid from personnages inner join rolesimportants on rolperid=perid inner join films on filid=rolfilid where filtitre ="Harry Potter à l'école des sorciers");
select DISTINCT pernom,perprenom,mainom from films inner join rolesimportants on rolfilid=filid inner join personnages on rolperid=perid inner join maisons on maiid=permaiid where filtitre="Harry Potter et la Chambre des secrets" or filTitre="Harry Potter à l'école des sorciers";
select pernom, perprenom from personnages inner join rolesimportants on perid=rolperid inner join films on rolfilid=filid where filid=(select filid from films where filcout = (select max(filcout) from films));
select count(perid) from personnages inner join maisons on permaiid=maiid where mainom='Gryffondor' and PerSexe="h";
select PerNom, PerPrenom, mainom from personnages inner join maisons on permaiid=maiid inner join rolesimportants on rolperid=perid INNER join films on rolfilid=filid where filannee=2006;
select pernom,count(*) as c from personnages inner join rolesimportants on rolperid=perid group by perid having c>3;
SELECT mainom,datediff(now(),maiDateCreation),maiDateCreation from maisons order by maidatecreation desc;
SELECT filtitre from films where filcout = (select max(filcout) from films);
select * from (select maiid as id1, mainom, count(perid) as nbr_h from personnages INNER join maisons on PerMaiID=maiid where persexe="h" group by maiid,mainom) as T1 inner join (select maiid as id2, count(perid) as nbr_f from personnages INNER join maisons on PerMaiID=maiid where persexe="f" group by maiid,mainom) as t2 on id1=id2 where nbr_f = nbr_h;
select sum(filcout) from films inner join rolesimportants on rolfilid=filid inner join personnages on perid=rolperid where perprenom="Sirius" and pernom="Black";
select mainom, count(persexe) as d from personnages inner join maisons on maiid=permaiid where persexe="f" group by mainom having d=(select max(c) from (select mainom, count(persexe) as c from personnages inner join maisons on maiid=permaiid where persexe="f" group by persexe,maiid) as t1);
select mainom, count(persexe) as d from personnages inner join maisons on maiid=permaiid where persexe="f" group by mainom having d=(select min(c) from (select mainom, count(persexe) as c from personnages inner join maisons on maiid=permaiid where persexe="f" group by persexe,maiid) as t1);
select pernom,count(*) as nbr_f from personnages inner join rolesimportants on rolperid=perid inner join films on filid=rolfilid group by pernom having nbr_f = (select count(*) from films);
select count(*) from(select pernom,count(*) as nbr_f from personnages inner join rolesimportants on rolperid=perid inner join films on filid=rolfilid group by pernom having nbr_f = (select count(*) from films)) as t1;
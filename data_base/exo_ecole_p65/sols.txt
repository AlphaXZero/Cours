select etusexe, floor(avg(datediff("2024-12-03",etunaiss)/365)) from etudiants group by etusexe;
select pronom,proprenom from professeurs inner join cours on proid=couproid where lower(counom)="Histoire";
select etunom,etuprenom,counom,ptscote from etudiants left join points on etuid=ptsetuid left join cours on ptscouid=couid where lower(counom)="sociologie" and ptscote is NULL;
select counom from cours inner join professeurs on couproid=proid where prostatut in ("MCF","AS");
select etunom,etuprenom,counom,ptscote from etudiants inner join points on ptsetuid=etuid inner join cours on couid=ptscouid order by etunom,etuprenom;
select etunom,floor(datediff("2024-12-03",etunaiss)/365),counom,ptscote,etusexe from etudiants inner join points on etuid=ptsetuid inner join cours on ptscouid=couid where lower(counom)="informatique" and ptscote > (select avg(ptscote) from points inner join cours on couid=ptscouid where lower(counom)="informatique");
select pronom,count(*) nbr_cours,ProStatut from professeurs left join cours on proid=couproid group by pronom,ProStatut having nbr_cours>1;
select counom,count(*) from (select counom, ptscote from cours left join points on ptscouid=couid having ptscote>=10) as t1 group by counom union select counom, 0 from cours where counom not in (select counom from (select counom, ptscote from cours left join points on ptscouid=couid having ptscote>=10) as t1 group by counom);
select etunom,etuprenom,etusexe,pts_math,pts_info from (select etuid,etuprenom,etunom,etusexe, ptscote as pts_math from cours left join points on ptscouid=couid left join etudiants on etuid=ptsetuid where lower(counom)="math√©matique") as t1 inner join (select etuid as et2, ptscote as pts_info from cours left join points on ptscouid=couid left join etudiants on etuid=ptsetuid where lower(counom)="informatique") as t2 on etuid=et2 where pts_math<pts_info;
select etunom,counom,ptscote from cours left join points on ptscouid=couid left join etudiants on ptsetuid = etuid where ptscote is null;
select counom,pronom,avg(ptscote) moyenne_ele from cours left join points on ptscouid=couid left join professeurs on  couproid=proid  group by counom,pronom having moyenne_ele<10;
select counom,etunom,maxi from etudiants inner join points on etuid=ptsetuid inner join cours on couid=ptscouid inner join (select counom maxicounom,couid maxicouid,max(ptscote) maxi from cours left join points on ptscouid=couid left join etudiants on etuid=ptsetuid group by counom,couid) as t1 on maxicouid=couid where maxi=ptscote;
select etusexe,count(*) from etudiants where etuid not in (select etuid from etudiants inner join points on etuid=ptsetuid inner join cours on couid=ptscouid group by etuid having min(ptscote)<10) group by etusexe;
select counom,etusexe,count(*),avg(ptscote) from etudiants join points on etuid=ptsetuid join cours on couid=ptscouid join professeurs on proid=couproid where pronom="Bernair" group by etusexe,counom order by counom;
select etunom,etuprenom, count(ptscote) nbr_reussis from (select etuid,etunom,etuprenom,ptscote from etudiants left join points on ptsetuid=etuid where ptscote>=10) as t1 group by etunom,etuprenom union select etunom,etuprenom, 0 nbr_reussis from etudiants where etuid not in (select ptsetuid from points where ptscote>=10);